<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>YouTube Summarize</title>
    <link rel="stylesheet" href="/static/style.css" />
    <script defer src="/static/app.js"></script>
  </head>
  <body>
    <main class="page">
      <header class="header">
        <h1>YouTube Summarize</h1>
        <p>Enter a YouTube URL or ID, customize prompt + schema, and get JSON output.</p>
      </header>

      <section class="card">
        <form id="summarize-form" class="form">
          <label>
            YouTube URL or ID
            <input type="text" name="video_input" value="{{ video_input }}" placeholder="9WWvLj-NqEE or https://..." required />
          </label>

          <label>
            Gemini model
            <input type="text" name="model" value="{{ default_model }}" />
          </label>

          <div class="preset-bar">
            <div class="preset-row">
              <label>
                Load preset
                <select id="preset-select">
                  <option value="">Select a preset</option>
                  {% for preset in presets %}
                    <option value="{{ preset.id }}" {% if preset.id == default_preset_id %}selected{% endif %}>
                      {{ preset.name }}
                    </option>
                  {% endfor %}
                </select>
              </label>
              <button type="button" id="load-preset" class="ghost">Load</button>
            </div>
            <div class="preset-row">
              <label>
                Save as
                <input type="text" id="preset-name" placeholder="e.g. Summary + Keywords" />
              </label>
              <button type="button" id="save-preset" class="ghost">Save</button>
            </div>
          </div>

          <label>
            Prompt
            <textarea name="prompt" rows="12">{{ default_prompt }}</textarea>
          </label>

          <div class="progress hidden" id="progress" hidden>
            <div class="progress-bar"></div>
            <span id="progress-text">Summarizing video...</span>
          </div>

          <input type="hidden" name="schema_json" id="schema-json" value="" />

          <div class="schema-builder">
            <div class="schema-header">
              <h2>Schema Builder</h2>
              <button type="button" id="add-field">Add Field</button>
              <button type="button" id="infer-schema">Infer Schema</button>
              <button type="button" id="toggle-raw">Show Raw Schema</button>
            </div>
            <div id="schema-fields"></div>
            <div id="raw-schema" class="raw-schema hidden">
              <label>
                Raw JSON Schema
                <textarea id="raw-schema-text" rows="14">{{ default_schema }}</textarea>
              </label>
            </div>
          </div>

          <button type="submit" id="submit-btn">Summarize</button>
        </form>

        <div class="error hidden" id="error" hidden></div>
      </section>

      <section class="card hidden" id="result-card" hidden>
        <div class="result-header">
          <h2>Result Preview</h2>
          <div class="result-actions">
            <button type="button" id="export-json" class="ghost">Export JSON</button>
            <button type="button" id="toggle-json">Show Raw JSON</button>
          </div>
        </div>
        <div id="result-preview"></div>
        <pre id="result-json" class="hidden" hidden></pre>
      </section>
    </main>
  </body>
</html>
